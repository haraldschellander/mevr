<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting the Metastatistical Extreme Value Distribution (MEVD) — fmev • mevr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting the Metastatistical Extreme Value Distribution (MEVD) — fmev"><meta name="description" content="Fit the MEVD distribution to rainfall observations with different estimation methods."><meta property="og:description" content="Fit the MEVD distribution to rainfall observations with different estimation methods."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mevr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting the Metastatistical Extreme Value Distribution (MEVD)</h1>

      <div class="d-none name"><code>fmev.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit the MEVD distribution to rainfall observations with different estimation methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fmev</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pwm"</span>, <span class="st">"mle"</span>, <span class="st">"ls"</span><span class="op">)</span>,</span>
<span>  censor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  censor_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data to which the MEVD should be fitted to. <code>data</code> must be a data.frame with two columns.
The first column must contain dates of class  <code>Date</code>, the second or last column must contain the rainfall
values corresponding to datums in the rows. No negative values are allowed. NA values are removed with a warning.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>A numeric that is used to define wet days as values &gt; threshold.
\(data &lt;= threshold\) is set to NA.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string describing the method that is used to estimate the
Weibull parameters c and w. Possible options are probability weighted moments (<code>method='pwm'</code>),
maximum likelihood (<code>method='mle'</code>) or least squares (<code>method='ls'</code>).
The <code>default</code> is <code>pwm</code>. (see details).</p></dd>


<dt id="arg-censor">censor<a class="anchor" aria-label="anchor" href="#arg-censor"></a></dt>
<dd><p>If <code>censor=TRUE</code>, the data series will be left-censored to assure that the observed maxima
are samples from a weibull tail. Defaults to <code>censor=FALSE</code>.</p></dd>


<dt id="arg-censor-opts">censor_opts<a class="anchor" aria-label="anchor" href="#arg-censor-opts"></a></dt>
<dd><p>An empty list which can be populated with components <code>thresholds</code>, <code>mon</code>, <code>nrtrials</code> and <code>R</code>.
They give the range of quantiles used as left-censoring threshold, the month with which the block starts,
the number of trials used to achieve a weibull fit to the left-censored sample, and the number of synthetic samples
used for the test statistics, respectively. See also <code><a href="weibull_tail_test.html">weibull_tail_test</a></code>.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>If <code>TRUE</code> which is the default, warnings about censoring are given.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>mevr</code> with the fitted Weibull parameters and other helpful ingredients.</p>
<dl><dt>c</dt>
<dd><p>vector of Weibull scale parameters of the MEVD, each component refers to one year.</p></dd>

<dt>w</dt>
<dd><p>vector of Weibull shape parameters of the MEVD, each component refers to one year.</p></dd>

<dt>n</dt>
<dd><p>Number of wet events per year. Wet events are defined as rainfall &gt; <code>threshold</code>.</p></dd>

<dt>params</dt>
<dd><p>A named vector of the fitted parameters.</p></dd>

<dt>maxima</dt>
<dd><p>Maximum values corresponding to each year.</p></dd>

<dt>data</dt>
<dd><p>\(data &gt;= threshold\) used to fit the MEVD and additional components which may be useful for further analysis.</p></dd>

<dt>years</dt>
<dd><p>Vector of years as YYYY.</p></dd>

<dt>threshold</dt>
<dd><p>The chosen threshold.</p></dd>

<dt>method</dt>
<dd><p>Method used to fit the MEVD.</p></dd>

<dt>type</dt>
<dd><p>The type of distribution ("MEVD")</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>With the aim of weakening the requirement of an asymptotic assumption for the GEV distribution,
a metastatistical approach was proposed by Marani and Ignaccolo (2015). The MEVD is defined
in terms of the distribution of the statistical parameters describing "ordinary" daily rainfall
occurrence and intensity. The MEVD accounts for the random process of event occurrence in each
block and the possibly changing probability distribution of event magnitudes across different blocks,
by recognizing the number of events in each block, n, and the values of the shape and scale
parameters w and C of the parent Weibull distribution to be realisations of stochastic variables.
The MEVD can then be written as</p>
<p>$$F = \frac{1}{T} \sum_{j=1}^T \prod_{k \in A_j} \left( 1-e^{-\left(\frac{x}{C(j,k)}\right)^{w(j,k)}} \right)$$</p>
<p>for \(w &gt; 0\) and \(C &gt; 0\). With T fully recorded years, yearly C and w can be estimated
by fitting a Weibull distribution to the values x of this year, and n is the number of ordinary
events per year, i.e. all rainfall events larger than a threshold.</p>
<p>If the probability distribution of daily rainfall is assumed to be time-invariant, the MEVD can be simplified to</p>
<p>$$F = [1 - exp(-x/C)^w]^n$$</p>
<p>with single values for the shape and scale parameters w and C. n is then the mean number of wet
days at this location (Marra et al., 2019; Schellander et al., 2019).</p>
<p>As is shown e.g. Schellander et al., 2019, probability weighted moments should be preferred
over maximum likelihood for the estimation of the Weibull parameters w and C.
Therefore <code>method = 'pwm'</code> is the default.</p>
<p>The MEVD can also be used for sub-daily precipitation (Marra et al., 2019).
In that case n has to be adapted accordingly to the 'mean number of wet events' per year.</p>
<p>This function returns the parameters of the fitted MEVD distribution as well as some
additional fitting results and input parameters useful for further analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Marani, M. and Ignaccolo, M. (2015) 'A metastatistical approach to rainfall extremes', Advances in Water Resources. Elsevier Ltd, 79(Supplement C), pp. 121-126. doi: 10.1016/j.advwatres.2015.03.001.</p>
<p>Schellander, H., Lieb, A. and Hell, T. (2019) 'Error Structure of Metastatistical and Generalized Extreme Value Distributions for Modeling Extreme Rainfall in Austria', Earth and Space Science, 6, pp. 1616-1632. doi: 10.1029/2019ea000557.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fsmev.html">fsmev</a></code>, <code><a href="ftmev.html">ftmev</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Harald Schellander, Alexander Lieb</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dailyrainfall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fmev</span><span class="op">(</span><span class="va">dailyrainfall</span>, method <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MEVD fitting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: MEVD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimator: mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale C:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   75.30   85.50   83.66  111.86   83.06  110.43   91.39   78.56   90.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]   84.84  100.45   77.33  105.16   90.53   89.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shape w:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.8109  0.9163  0.8648  0.9482  0.8515  0.9411  0.8937  0.8472  0.8564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]  0.9128  0.9329  0.8363  0.8421  0.9537  0.8436</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wet events n:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  151  148  187  190  169  157  185  193  202  211  202  176  169  170  178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Years:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fmev-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Harald Schellander.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

