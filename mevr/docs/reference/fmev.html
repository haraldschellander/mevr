<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting the Metastatistical Extreme Value Distribution (MEVD) — fmev • mevr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting the Metastatistical Extreme Value Distribution (MEVD) — fmev"><meta property="og:description" content="Fit the MEVD distribution to rainfall observations with different estimation methods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mevr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting the Metastatistical Extreme Value Distribution (MEVD)</h1>
    
    <div class="hidden name"><code>fmev.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit the MEVD distribution to rainfall observations with different estimation methods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fmev</span><span class="op">(</span><span class="va">data</span>, threshold <span class="op">=</span> <span class="fl">0</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pwm"</span>, <span class="st">"mle"</span>, <span class="st">"ls"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>The data to which the MEVD should be fitted to. <code>data</code> must be a data.frame with two columns. 
The first column must contain dates of class  <code>Date</code>, the second or last column must contain the rainfall 
values corresponding to datums in the rows. No NA values are allowed.</p></dd>


<dt>threshold</dt>
<dd><p>A numeric that is used to define wet days as values &gt; threshold. 
\(data &lt;= threshold\) is set to NA.</p></dd>


<dt>method</dt>
<dd><p>Character string describing the method that is used to estimate the 
Weibull parameters c and w. Possible options are probability weighted moments (<code>method='pwm'</code>), 
maximum likelihood (<code>method='mle'</code>) or least squares (<code>method='ls'</code>). 
The <code>default</code> is <code>pwm</code>. (see details).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of class <code>mevr</code> with the fitted Weibull parameters and other helpful ingredients.</p>
<dl><dt>c</dt>
<dd><p>vector of Weibull scale parameters of the MEVD, each component refers to one year.</p></dd>

<dt>w</dt>
<dd><p>vector of Weibull shape parameters of the MEVD, each component refers to one year.</p></dd>

<dt>n</dt>
<dd><p>Number of wet events per year. Wet events are defined as rainfall &gt; <code>threshold</code>.</p></dd>

<dt>params</dt>
<dd><p>A named vector of the fitted parameters.</p></dd>

<dt>maxima</dt>
<dd><p>Maximum values corresponding to each year.</p></dd>

<dt>data</dt>
<dd><p>\(data &gt;= threshold\) used to fit the MEVD and additional components which may be useful for further analysis.</p></dd>

<dt>years</dt>
<dd><p>Vector of years as YYYY.</p></dd>

<dt>threshold</dt>
<dd><p>The chosen threshold.</p></dd>

<dt>method</dt>
<dd><p>Method used to fit the MEVD.</p></dd>

<dt>type</dt>
<dd><p>The type of distribution ("MEVD")</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>With the aim of weakening the requirement of an asymptotic assumption for the GEV distribution, 
a metastatistical approach was proposed by Marani and Ignaccolo (2015). The MEVD is defined 
in terms of the distribution of the statistical parameters describing "ordinary" daily rainfall 
occurrence and intensity. The MEVD accounts for the random process of event occurrence in each 
block and the possibly changing probability distribution of event magnitudes across different blocks, 
by recognizing the number of events in each block, n, and the values of the shape and scale 
parameters w and C of the parent Weibull distribution to be realisations of stochastic variables. 
The MEVD can then be written as</p>
<p>$$F = \frac{1}{T} \sum_{j=1}^T \prod_{k \in A_j} \left( 1-e^{-\left(\frac{x}{C(j,k)}\right)^{w(j,k)}} \right)$$</p>
<p>for \(w &gt; 0\) and \(C &gt; 0\). With T fully recorded years, yearly C and w can be estimated 
by fitting a Weibull distribution to the values x of this year, and n is the number of ordinary 
events per year, i.e. all rainfall events larger than a threshold.</p>
<p>If the probability distribution of daily rainfall is assumed to be time-invariant, the MEVD can be simplified to</p>
<p>$$F = [1 - exp(-x/C)^w]^n$$</p>
<p>with single values for the shape and scale parameters w and C. n is then the mean number of wet 
days at this location (Marra et al., 2019; Schellander et al., 2019).</p>
<p>As is shown e.g. Schellander et al., 2019, probability weighted moments should be preferred 
over maximum likelihood for the estimation of the Weibull parameters w and C. 
Therefore <code>method = 'pwm'</code> is the default.</p>
<p>The MEVD can also be used for sub-daily precipitation (Marra et al., 2019). 
In that case n has to be adapted accordingly to the 'mean number of wet events' per year.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Marani, M. and Ignaccolo, M. (2015) 'A metastatistical approach to rainfall extremes', Advances in Water Resources. Elsevier Ltd, 79(Supplement C), pp. 121-126. doi: 10.1016/j.advwatres.2015.03.001.</p>
<p>Schellander, H., Lieb, A. and Hell, T. (2019) 'Error Structure of Metastatistical and Generalized Extreme Value Distributions for Modeling Extreme Rainfall in Austria', Earth and Space Science, 6, pp. 1616-1632. doi: 10.1029/2019ea000557.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fsmev.html">fsmev</a></code>, <code><a href="ftmev.html">ftmev</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Harald Schellander, Alexander Lieb</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dailyrainfall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fmev</span><span class="op">(</span><span class="va">dailyrainfall</span>, method <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MEVD fitting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: MEVD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimator: mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale C:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   75.30   85.50   83.66  111.86   83.06  110.43   91.39   78.56   90.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]   84.84  100.45   77.33  105.16   90.53   89.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shape w:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.8109  0.9163  0.8648  0.9482  0.8515  0.9411  0.8937  0.8472  0.8564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10]  0.9128  0.9329  0.8363  0.8421  0.9537  0.8436</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wet days n:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  151  148  187  190  169  157  185  193  202  211  202  176  169  170  178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Years:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fmev-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Harald Schellander.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

